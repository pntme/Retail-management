# üöÄ Render Deployment Guide

Complete guide to deploying the Retail Management System on Render with persistent storage.

## Table of Contents
1. [Overview](#overview)
2. [Prerequisites](#prerequisites)
3. [Deployment Steps](#deployment-steps)
4. [Configuration Details](#configuration-details)
5. [Data Persistence](#data-persistence)
6. [Troubleshooting](#troubleshooting)
7. [Monitoring & Maintenance](#monitoring--maintenance)

---

## Overview

**Why Render?**
- ‚úÖ Free tier available (750 hours/month)
- ‚úÖ Automatic HTTPS/SSL certificates
- ‚úÖ Auto-deploy from GitHub
- ‚úÖ Built-in persistent disk storage
- ‚úÖ Zero-downtime deploys
- ‚úÖ Easy environment variable management
- ‚úÖ Built-in metrics and monitoring
- ‚úÖ No credit card required for free tier

**What You Get:**
- Web application accessible via HTTPS
- Persistent SQLite database
- Automatic deployments on git push
- Professional subdomain (e.g., retail-management.onrender.com)
- Custom domain support (optional)

---

## Prerequisites

1. **GitHub Account**
   - Your code must be in a GitHub repository
   - Repository can be public or private

2. **Render Account**
   - Sign up at [render.com](https://render.com) (free)
   - Can sign up with GitHub for easier integration

3. **Project Ready**
   - This repository already includes `render.yaml` configuration
   - No code changes needed!

---

## Deployment Steps

### Method 1: Blueprint Deployment (Recommended)

This method uses the included `render.yaml` file for automated setup.

#### Step 1: Push Code to GitHub

```bash
# If not already a git repository
git init
git add .
git commit -m "Initial commit"

# Push to GitHub
git remote add origin https://github.com/YOUR_USERNAME/YOUR_REPO.git
git branch -M main
git push -u origin main
```

#### Step 2: Deploy on Render

1. **Go to [Render Dashboard](https://dashboard.render.com/)**

2. **Click "New +" ‚Üí "Blueprint"**

3. **Connect Repository:**
   - Click "Connect" next to GitHub
   - Authorize Render to access your repositories
   - Select your retail management repository

4. **Blueprint Configuration:**
   - Render will automatically detect the `render.yaml` file
   - Review the service configuration:
     - Service name: `retail-management`
     - Type: Web Service
     - Runtime: Node.js
     - Disk: 1GB persistent storage at `/data`

5. **Click "Apply"**
   - Render will create the service with all configurations
   - Build will start automatically

6. **Wait for Deployment:**
   - Watch the build logs in real-time
   - Initial deployment takes 2-5 minutes
   - You'll see:
     ```
     ==> Installing dependencies
     ==> Building...
     ==> Starting server
     ==> Your service is live üéâ
     ```

7. **Access Your Application:**
   - Your app will be available at: `https://retail-management.onrender.com`
   - Or the custom URL shown in your dashboard

### Method 2: Manual Deployment

If you prefer manual setup or need custom configuration:

#### Step 1: Create Web Service

1. Go to [Render Dashboard](https://dashboard.render.com/)
2. Click "New +" ‚Üí "Web Service"
3. Connect your GitHub repository
4. Select your retail management repository

#### Step 2: Configure Service

**Basic Configuration:**
- **Name:** `retail-management` (or your preferred name)
- **Region:** Choose closest to your users
- **Branch:** `main` (or your deployment branch)
- **Runtime:** Node
- **Build Command:** `npm install`
- **Start Command:** `node server.js`

**Environment Variables:**
Add these in the "Environment" section:

| Key | Value |
|-----|-------|
| `NODE_ENV` | `production` |
| `PORT` | `3001` |
| `DATA_DIR` | `/data` |
| `DB_PATH` | `/data/retail.db` |
| `UPLOADS_DIR` | `/data/uploads` |
| `JWT_SECRET` | (Generate a random string) |

**Instance Type:**
- Free tier: Select "Free" (750 hours/month)
- Paid tier: Select "Starter" or higher for better performance

#### Step 3: Add Persistent Disk

‚ö†Ô∏è **CRITICAL:** Without this, your data will be lost on every deploy!

1. Scroll to "Disks" section
2. Click "Add Disk"
3. Configure:
   - **Name:** `retail-data`
   - **Mount Path:** `/data`
   - **Size:** `1 GB` (increase as needed)
4. Click "Create Disk"

#### Step 4: Deploy

1. Click "Create Web Service"
2. Render will start building and deploying
3. Monitor build logs for any issues

---

## Configuration Details

### Environment Variables Explained

```yaml
NODE_ENV=production          # Sets production mode
PORT=3001                   # Application port
DATA_DIR=/data              # Base directory for persistent data
DB_PATH=/data/retail.db     # SQLite database file location
UPLOADS_DIR=/data/uploads   # Directory for uploaded files
JWT_SECRET=<auto-generated> # Secret key for JWT tokens (auto-generated)
```

### Persistent Disk Setup

The disk mounted at `/data` stores:
- **Database:** `retail.db` - All your business data
- **Uploads:** Product images, documents, etc.
- **Logs:** Application logs (if configured)

**Important Notes:**
- Disk persists across deployments
- Disk is backed up automatically by Render
- Can be resized in the dashboard (requires brief downtime)
- Disk size affects pricing on paid plans

### Auto-Deploy Configuration

The `render.yaml` includes `autoDeploy: true`, which means:
- Every push to your main branch triggers a deployment
- Can be changed in Render dashboard settings
- Can set up different branches for staging/production

---

## Data Persistence

### Understanding Render's File System

Render uses:
- **Ephemeral Storage:** Everything outside `/data` is wiped on each deploy
- **Persistent Disk:** The `/data` directory persists between deployments

### Database Location

The application is configured to store the database at:
```
/data/retail.db
```

This ensures your data survives deployments and restarts.

### File Uploads

All uploaded files (product images, etc.) are stored in:
```
/data/uploads/
```

These files persist across deployments.

### Initial Setup

On first deployment:
1. App creates `/data` and `/data/uploads` directories
2. SQLite creates `retail.db` with all tables
3. Database is ready to use immediately

### Data Migration

If you have existing data from local development:

```bash
# 1. Get shell access to your Render service
# In Render Dashboard ‚Üí Shell tab

# 2. Upload your local database (from your computer)
# Use Render's file upload feature or:
# - Download your local retail.db
# - Use Render shell to download from a URL
# - Or use the database migration SQL

# 3. Restart the service
# The app will use the uploaded database
```

---

## Troubleshooting

### Common Issues

#### 1. Build Fails

**Error:** `npm install failed`
```bash
# Solution: Check package.json is valid
# Ensure all dependencies are listed
```

**Error:** `Node version mismatch`
```bash
# Solution: Add .node-version file
echo "18" > .node-version
git commit -am "Add Node version"
git push
```

#### 2. App Crashes on Start

**Check Logs:**
- Go to Dashboard ‚Üí Logs
- Look for error messages

**Common Causes:**
- Port mismatch (ensure PORT=3001 in env vars)
- Missing environment variables
- Database permission issues

**Fix:**
```bash
# Verify environment variables in Render dashboard
# Ensure DATA_DIR=/data is set
# Check if disk is properly mounted
```

#### 3. Data Not Persisting

**Symptoms:**
- Data disappears after deployment
- Database resets on every deploy

**Solution:**
1. Verify disk is added and mounted at `/data`
2. Check environment variables point to `/data`:
   ```
   DB_PATH=/data/retail.db
   UPLOADS_DIR=/data/uploads
   ```
3. Restart service

#### 4. Connection Issues

**Error:** `Cannot connect to database`
```bash
# Check logs for:
# - Database file permissions
# - Directory creation errors
# - Disk mount issues
```

**Solution:**
- Ensure `/data` directory exists
- Verify disk is properly mounted
- Check service logs for errors

#### 5. Slow Performance

**Free Tier Limitations:**
- Services spin down after 15 minutes of inactivity
- First request after spin-down takes 30-60 seconds
- Subsequent requests are fast

**Solutions:**
- Upgrade to paid plan (always-on)
- Use a uptime monitor to keep service active (free tier workaround)
- Accept the delay for free hosting

### Getting Help

1. **Check Logs:**
   - Dashboard ‚Üí Your Service ‚Üí Logs
   - Enable live tail for real-time logging

2. **Use Render Shell:**
   - Dashboard ‚Üí Your Service ‚Üí Shell
   - Access your running service directly
   ```bash
   ls -la /data
   cat /data/retail.db  # Check if database exists
   ```

3. **Render Support:**
   - Check [Render Docs](https://render.com/docs)
   - Community Forum: [community.render.com](https://community.render.com)
   - Email: support@render.com

---

## Monitoring & Maintenance

### Built-in Metrics

Render provides automatic monitoring:
- **Response Times:** Average, P95, P99
- **Request Volume:** Requests per second
- **Memory Usage:** Current and historical
- **CPU Usage:** Service resource consumption
- **Bandwidth:** Incoming/outgoing traffic

Access via: Dashboard ‚Üí Your Service ‚Üí Metrics

### Health Checks

The `render.yaml` includes:
```yaml
healthCheckPath: /
```

This tells Render to ping your homepage regularly to ensure the service is running.

### Logs

**Access Logs:**
1. Dashboard ‚Üí Your Service ‚Üí Logs
2. Enable "Live Tail" for real-time monitoring
3. Download logs for analysis

**Log Retention:**
- Free tier: Last 7 days
- Paid tiers: Up to 30 days

### Backups

**Automatic Disk Backups:**
- Render backs up persistent disks automatically
- Can restore from backups if needed
- Available in Dashboard ‚Üí Disks

**Manual Database Backup:**
```bash
# Option 1: Download via Shell
# 1. Go to Dashboard ‚Üí Shell
# 2. Run:
cat /data/retail.db | base64

# Copy output and decode locally
# base64 -d > backup.db

# Option 2: Automated script
# Add a backup endpoint in server.js
```

### Maintenance Tasks

**Weekly:**
- Check logs for errors
- Review metrics for anomalies
- Test application functionality

**Monthly:**
- Review disk usage (Dashboard ‚Üí Disks)
- Update dependencies if needed
- Check for security updates

**Quarterly:**
- Database optimization (if needed)
- Review and clear old logs
- Performance testing

### Scaling

**Vertical Scaling (More Resources):**
1. Dashboard ‚Üí Your Service ‚Üí Settings
2. Change "Instance Type"
3. Options: Free ‚Üí Starter ‚Üí Standard ‚Üí Pro
4. Adjust as your traffic grows

**Disk Expansion:**
1. Dashboard ‚Üí Disks ‚Üí retail-data
2. Click "Resize"
3. Enter new size
4. Confirm (brief downtime during resize)

---

## Custom Domain

### Adding Your Own Domain

1. **In Render Dashboard:**
   - Go to Your Service ‚Üí Settings
   - Scroll to "Custom Domains"
   - Click "Add Custom Domain"
   - Enter your domain: `www.yourdomain.com`

2. **In Your DNS Provider:**
   Add a CNAME record:
   ```
   Type: CNAME
   Name: www
   Value: retail-management.onrender.com
   TTL: 3600
   ```

3. **SSL Certificate:**
   - Render automatically provisions SSL
   - Takes 5-15 minutes
   - Your site will be available at `https://www.yourdomain.com`

---

## Cost Estimate

### Free Tier
- **Cost:** $0/month
- **Includes:**
  - 750 hours/month (enough for 1 always-on service)
  - Automatic HTTPS
  - 1GB persistent disk (included)
  - Custom domains
- **Limitations:**
  - Spins down after 15 min inactivity
  - Slower performance
  - 7-day log retention

### Paid Plans

**Starter ($7/month):**
- Always-on service
- Better performance
- More disk space
- 30-day logs

**Standard ($25/month):**
- Enhanced resources
- Priority support
- Advanced metrics

**Disk Storage:**
- 1GB included (free tier)
- Additional storage: $0.25/GB/month

---

## Comparison: Render vs Railway vs Heroku

| Feature | Render | Railway | Heroku |
|---------|--------|---------|--------|
| Free Tier | ‚úÖ 750 hrs | ‚úÖ $5 credit | ‚ùå (Paid only) |
| Persistent Disk | ‚úÖ Built-in | ‚úÖ Volumes | ‚ùå Add-ons only |
| Auto HTTPS | ‚úÖ Yes | ‚úÖ Yes | ‚úÖ Yes |
| Auto Deploy | ‚úÖ Yes | ‚úÖ Yes | ‚úÖ Yes |
| Custom Domains | ‚úÖ Free | ‚úÖ Free | ‚úÖ Paid only |
| Startup Time | ~30-60s | ~20-40s | ~30-60s |
| Ease of Use | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê |

---

## Next Steps

After successful deployment:

1. **Test Your Application:**
   - Visit your Render URL
   - Create test data
   - Deploy again and verify data persists

2. **Configure Monitoring:**
   - Set up uptime monitoring (UptimeRobot, etc.)
   - Configure alerts for downtime

3. **Secure Your App:**
   - Add authentication (if not already)
   - Review environment variables
   - Enable rate limiting

4. **Optimize Performance:**
   - Monitor metrics in dashboard
   - Upgrade instance type if needed
   - Optimize database queries

5. **Set Up Backups:**
   - Create manual backup routine
   - Test database restoration

---

## Helpful Commands

```bash
# Check current deployment
git log -1

# Deploy new changes
git add .
git commit -m "Your changes"
git push origin main

# Roll back to previous version
# (Use Render dashboard ‚Üí Deploys ‚Üí Redeploy previous version)

# View live logs
# (Use Render dashboard ‚Üí Logs ‚Üí Live Tail)

# Access service shell
# (Use Render dashboard ‚Üí Shell)
```

---

## Quick Reference

**Render Dashboard:** https://dashboard.render.com
**Documentation:** https://render.com/docs
**Community Forum:** https://community.render.com
**Status Page:** https://status.render.com

**Your Service URL Format:**
`https://[your-service-name].onrender.com`

**Data Directory:**
`/data` (persistent)

**Database Location:**
`/data/retail.db`

**Uploads Directory:**
`/data/uploads`

---

## Success Checklist

After deployment, verify:

- [ ] Application is accessible via HTTPS URL
- [ ] Can create customers, products, sales
- [ ] Data persists after redeployment
- [ ] Images/uploads are saved and accessible
- [ ] No errors in logs
- [ ] Health check is passing
- [ ] Metrics are being collected
- [ ] Auto-deploy is working (push to GitHub triggers deploy)

---

## Congratulations! üéâ

Your Retail Management System is now live on Render!

**What you've achieved:**
- ‚úÖ Professional cloud deployment
- ‚úÖ Automatic HTTPS security
- ‚úÖ Persistent data storage
- ‚úÖ Automatic deployments
- ‚úÖ Built-in monitoring

Your business is now running on enterprise-grade infrastructure! üöÄ

For questions or issues, check the Troubleshooting section or visit the Render documentation.
